var tour={};function initTour(t){isBreakpoint("xs")?alert("Please use a larger screen to view the tutorial."):($("#chartTradeModal").modal("hide"),$("#chartTimeModal").modal("hide"),t.init(),2<t.getCurrentStep()&&(t.setCurrentStep(2),t.init()),t.restart(),t.start(!0),$("body").addClass("tour").addClass("tour-step-"+t.getCurrentStep()).append('<div class="tour-lock"></div>'))}function tourAfterDrawn(){$("body").hasClass("tour-step-2")?$(".tour-step-background").height($(".chart-group:first").height()):$("body").hasClass("tour-step-8")?($(".tour-step-background").height($(".chart-item-table:first-child").height()).width($(".chart-item-table:first-child").width()),setTimeout(function(){$(".chart-item-table:first-child .table-responsive").animate({scrollLeft:"+="+$(".chart-item-table:first-child .table-responsive .table").width()/3},1e3)},1e3),setTimeout(function(){$(".chart-item-table:first-child .table-responsive").animate({scrollLeft:"-="+$(".chart-item-table:first-child .table-responsive .table").width()/3},1e3)},2e3)):$("body").hasClass("tour-step-11")?tour.next():$("body").hasClass("tour-step-12")&&$(".chart-item:first .btn-group:first").addClass("forcedopen")}$(function(){tour=new Tour({name:"systemDemoTour",backdrop:!0,keyboard:!1,smartPlacement:!1,debug:!1,onShown:function(t){var e=t.getCurrentStep();$("body").removeClass(function(t,e){return(e.match(/(^|\s)tour-step-\S+/g)||[]).join(" ")}).addClass("tour-step-"+e),$(".tour #tourOnLogin").prop("checked","1"==siteData.data("tour-login"))},onEnd:function(t){$("body").removeClass("tour"),$.ajax({url:siteData.data("url")+"/user/tourToggle",dataType:"json",data:"ajax=1"})},template:"<div class='popover tour'><div class='arrow'></div><h3 class='popover-title'></h3><div class='popover-content'></div><div class='popover-navigation'><div class='row'><div class='col-xs-8'><p class='btn-group'><button class='btn btn-default btn-sm' data-role='prev'><span class='fa fa-arrow-left'></span> Prev</button><button class='btn btn-default btn-sm' data-role='next'>Next <span class='fa fa-arrow-right'></span></button></p></div><div class='col-xs-4'><p class='btn-group'><button class='btn btn-default btn-sm' data-role='end'><span class='fa fa-times'></span> End</button></p></div></div><div class='checkbox margin-0'><label class='control-label'><input type='checkbox' value='1' name='tourOnLogin' id='tourOnLogin' "+("1"==siteData.data("tour-login")?"checked='checked'":"")+" /> Show tutorial on next login</label></div></div></div>",delay:{show:500,hide:100},steps:[{orphan:!0,title:"Complete Intelligence Tutorial",content:"Welcome to our quick and easy tutorial. Click 'Next' to continue or click 'End' to close the tutorial.",placement:"bottom",path:"/"},{element:"#tour-step-1",title:"Searching for a country",content:"This allows you to select a country. We will try searching for Canada.",placement:"bottom",path:"/",onShown:function(t){var e=t.getCurrentStep();$("body").removeClass(function(t,e){return(e.match(/(^|\s)tour-step-\S+/g)||[]).join(" ")}).addClass("tour-step-"+e),$(".tour #tourOnLogin").prop("checked","1"==siteData.data("tour-login")),$(".tour-step-background").height($("#chartTimeModal .modal-content").height()).width($("#chartTimeModal .modal-content").width()),setTimeout(function(){$("#search").typeahead("val","C")},300),setTimeout(function(){$("#search").typeahead("val","Ca")},400),setTimeout(function(){$("#search").typeahead("val","Can")},500),setTimeout(function(){$("#search").typeahead("val","Cana")},600),setTimeout(function(){$("#search").typeahead("val","Canad")},700),setTimeout(function(){$("#search").typeahead("val","Canada").typeahead("open")},800)}},{element:".chart-group",title:"Time Range",content:"By default, the graph shows total trade for a 24 month period.",placement:"top",path:"/trade/country/CAN"},{element:".chart-group-header .btn-group:last .dropdown-item[data-target=#chartTradeModal]",title:"Adding an indicator",content:"The 'Add Indicator' button allows you to add more data reports.",placement:"left",path:"/trade/country/CAN",onShow:function(t){$(".chart-group-header .btn-group:last").addClass("forcedopen")},onHide:function(t){$(".chart-group-header .btn-group:last").removeClass("forcedopen")}},{element:"#chartTradeModal .modal-body",title:"Selecting an indicator",content:"Here you can choose any indicator based on several factors. We will try this with 'Top 10 Export Partners'.",placement:"top",path:"/trade/country/CAN",onShow:function(t){$("#chartTradeModal").modal("show"),$("#chartTradeModal").data("chart-id",$(".chart-group:first").data("chart-id"))},onShown:function(t){var e=t.getCurrentStep();$("body").removeClass(function(t,e){return(e.match(/(^|\s)tour-step-\S+/g)||[]).join(" ")}).addClass("tour-step-"+e),$(".tour #tourOnLogin").prop("checked","1"==siteData.data("tour-login")),$("#aimIndicator").selectpicker("val","top10-partner-ev").trigger("change")},onNext:function(t){$(".chart-item").each(function(t){0<t&&$(this).find(".chart-btn-remove").trigger("click")}),$("#chartTradeModal").data("chart-id",$(".chart-group:first").data("chart-id")),$(".chart-submit-btn").data("update","add"),$("#chartTradeModal .chart-submit-btn").trigger("click"),$("#chartTradeModal").modal("hide")},onHide:function(t){$("#chartTradeModal").modal("hide")}},{element:".chart-period",title:"Report periods",content:"By default, data is shown in monthly intervals. You can change the interval to quarterly or annual by clicking these button. Let's try 'Quarterly'.",placement:"bottom",path:"/trade/country/CAN",onNext:function(t){$('.chart-period .btn[data-period="quarter"]').trigger("click")},onPrev:function(t){$('.chart-period .btn[data-period="month"]').trigger("click")}},{element:".chart-time",title:"Changing the date",content:"With this button you can customize the date range for the indicator.",placement:"bottom",path:"/trade/country/CAN"},{element:"#chartTimeModal .modal-content",title:"Selecting dates",content:"You can select dates as early as 2010 to as advanced as 2020. We will try "+moment().subtract(3,"year").format("YYYY")+" to "+moment().add(1,"year").format("YYYY")+".",placement:"top",path:"/trade/country/CAN",onShow:function(t){var e=moment().subtract(3,"year").startOf("month"),a=moment().startOf("month").add(1,"year"),o=$(".chart-item-data[data-chart-id="+$(".chart-item:first").data("chart-id")+"]");o.data("start-time",e.format("MMM YYYY")),o.data("end-time",a.format("MMM YYYY")),$("#chartTimeModal").modal("show")},onShown:function(t){var e=t.getCurrentStep();$("body").removeClass(function(t,e){return(e.match(/(^|\s)tour-step-\S+/g)||[]).join(" ")}).addClass("tour-step-"+e),$(".tour #tourOnLogin").prop("checked","1"==siteData.data("tour-login")),$(".tour-step-background").height($("#chartTimeModal .modal-content").height()).width($("#chartTimeModal .modal-content").width())},onNext:function(t){$("#chartTimeModal .chart-submit-btn").trigger("click"),$("#chartTimeModal").modal("hide")},onPrev:function(t){$("#chartTimeModal").modal("hide")}},{element:".chart-item-table:first",title:"Large tables",content:"You can scroll this bar to see more of the data.",placement:"bottom",path:"/trade/country/CAN"},{element:".chart-item:first .dropdown-menu .chart-edit-btn",title:"Changing an indicator",content:"This time let's try 'Edit Indicator' and change the indicator to 'Imports by Partner'.",placement:"left",path:"/trade/country/CAN",onShow:function(t){$(".chart-item:first .btn-group:first").addClass("forcedopen")},onHide:function(t){$(".chart-item:first .btn-group:first").removeClass("forcedopen")}},{element:"#chartTradeModal .modal-body",title:"Selecting a sector",content:"We need to select a sector. You can search for a sector or click 'List All' to see all available sectors.",placement:"top",path:"/trade/country/CAN",onShow:function(t){$("#chartTradeModal").modal("show"),"function"==typeof tradeFormPreset&&tradeFormPreset($(".chart-item:first").data("chart-id"))},onShown:function(t){var e=t.getCurrentStep();$("body").removeClass(function(t,e){return(e.match(/(^|\s)tour-step-\S+/g)||[]).join(" ")}).addClass("tour-step-"+e),$(".tour #tourOnLogin").prop("checked","1"==siteData.data("tour-login")),$(".tour-step-background").height($("#chartTradeModal .modal-content").height()).width($("#chartTradeModal .modal-content").width()),$("#aimIndicator").selectpicker("val","trade-sector-iv").trigger("change"),setTimeout(function(){$("#chartTradeModal #aimSector-1").typeahead("val","P")},300),setTimeout(function(){$("#chartTradeModal #aimSector-1").typeahead("val","Pe")},400),setTimeout(function(){$("#chartTradeModal #aimSector-1").typeahead("val","Pet")},500),setTimeout(function(){$("#chartTradeModal #aimSector-1").typeahead("val","Petr")},600),setTimeout(function(){$("#chartTradeModal #aimSector-1").typeahead("val","Petro")},700),setTimeout(function(){$("#chartTradeModal #aimSector-1").typeahead("val","Petrol").typeahead("open")},800),setTimeout(function(){$("#chartTradeModal #aimSector-1").typeahead("close"),$("#chartTradeModal .chart-search-list-sector").data("field","aimSector-1"),$("#chartTradeModal .chart-search-list-sector .list-group-item[data-ref=2709]").trigger("click")},1800)},onNext:function(t){$("#chartTradeModal .chart-search-list-sector").data("field","aimSector-1"),$("#chartTradeModal .chart-search-list-sector .list-group-item[data-ref=2709]").trigger("click"),$("#chartTradeModal .chart-submit-btn").trigger("click"),$("#chartTradeModal").modal("hide")},onPrev:function(t){$("#chartTradeModal").modal("hide")}},{orphan:!0,title:"<i class='fa fa-spinner fa-spin'></i> Loading...",content:"",placement:"bottom",path:"/trade/country/CAN",template:"<div class='popover tour'><div class='arrow'></div><h3 class='popover-title'></h3></div>",onShown:function(t){var e=t.getCurrentStep();$("body").removeClass(function(t,e){return(e.match(/(^|\s)tour-step-\S+/g)||[]).join(" ")}).addClass("tour-step-"+e),$(".tour #tourOnLogin").prop("checked","1"==siteData.data("tour-login")),void 0!==$("body").data("tour-force-prev")&&"active"===$("body").data("tour-force-prev")&&($("body").data("tour-force-prev","inactive"),t.prev())}},{element:".chart-item:first .dropdown-menu .dropdown-item[data-target=#chartCompareModal]",title:"Comparing countries",content:"Now let's use the 'Compare Country' button to add a comparison country.",placement:"left",path:"/trade/country/CAN",onShow:function(t){$(".chart-item:first .btn-group:first").addClass("forcedopen")},onHide:function(t){$(".chart-item:first .btn-group:first").removeClass("forcedopen")},onPrev:function(t){$("body").data("tour-force-prev","active")}},{element:"#chartCompareModal .modal-body",title:"Selecting a comparison country",content:"We need to select a comparison country. You can search for a country or click 'List All' to see all available countries.",placement:"top",path:"/trade/country/CAN",onShow:function(t){$("#chartCompareModal").modal("show"),$("#chartCompareModal").data("chart-id",$(".chart-item:first").data("chart-id")),$("#chartCompareModal").data("chart-id",$(".chart-item:first").data("chart-id"))},onShown:function(t){var e=t.getCurrentStep();$("body").removeClass(function(t,e){return(e.match(/(^|\s)tour-step-\S+/g)||[]).join(" ")}).addClass("tour-step-"+e),$(".tour #tourOnLogin").prop("checked","1"==siteData.data("tour-login")),$("#aimIndicator").selectpicker("val","trade-sector-iv").trigger("change"),setTimeout(function(){$("#chartCompareModal #ccmReporter-1").typeahead("val","G")},300),setTimeout(function(){$("#chartCompareModal #ccmReporter-1").typeahead("val","Ge")},400),setTimeout(function(){$("#chartCompareModal #ccmReporter-1").typeahead("val","Ger")},500),setTimeout(function(){$("#chartCompareModal #ccmReporter-1").typeahead("val","Germ")},600),setTimeout(function(){$("#chartCompareModal #ccmReporter-1").typeahead("val","Germa")},700),setTimeout(function(){$("#chartCompareModal #ccmReporter-1").typeahead("val","German")},800),setTimeout(function(){$("#chartCompareModal #ccmReporter-1").typeahead("val","Germany").typeahead("open")},900),setTimeout(function(){$("#chartCompareModal #ccmReporter-1").typeahead("close"),$("#chartCompareModal .chart-search-list-reporter").data("field","ccmReporter-1"),$("#chartCompareModal .chart-search-list-reporter .list-group-item[data-ref=DEU]").trigger("click")},1800)},onNext:function(t){$("#chartCompareModal").data("chart-id",$(".chart-item:first").data("chart-id")),$("#chartCompareModal .chart-search-list-reporter").data("field","ccmReporter-1"),$("#chartCompareModal .chart-search-list-reporter .list-group-item[data-ref=DEU]").trigger("click"),$("#chartCompareModal .chart-submit-btn").trigger("click"),$("#chartCompareModal").modal("hide")},onPrev:function(t){$("#chartCompareModal").modal("hide")}},{element:"#tour-step-14",title:"Support",content:"Click the button in top right of the screen to open the main menu, and then select one of the following 3 options for extra help &amp; support.<br><br>Use the FAQ button to get answers to common questions, use the tutorial button to turn this tutorial on and off or click the support link to contact our support team.",placement:"left",path:"/trade/country/CAN",onShow:function(t){$(".header .nav .dropdown").addClass("forcedopen")},onHide:function(t){$(".header .nav .dropdown").removeClass("forcedopen")}},{orphan:!0,title:"<span class='fa fa-trophy'></span> Tutorial Completed",content:"Congratulations! You've just finished our nifty tutorial.",placement:"bottom",path:"/trade/country/CAN"}]}),"0"==siteData.data("tour")&&($(".pageLoading").is(":visible")?setTimeout(function(){initTour(tour)},1e4):initTour(tour)),$(document).on("change",".tour #tourOnLogin",function(){var t=0;$(this).prop("checked")&&(t=1),siteData.data("tour-login",t),$.ajax({url:siteData.data("url")+"/user/tourLoginToggle",dataType:"json",method:"post",data:{active:t}})})});