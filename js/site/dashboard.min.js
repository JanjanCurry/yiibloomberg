function dashboardRefreshTypeahead(a,t){var d=[];(a=void 0!==a&&a)||(t.find(".chart-item-data").each(function(){void 0!==$(this).data("item")?d.push($(this).data("item")):void 0!==$(this).data("reporter")&&d.push($(this).data("reporter"))}),d.join(),filterLists($("#dashSparkModal .chart-search-list-commodity"),{type:"commodity",restrict:d,selected:d}),filterLists($("#dashSparkModal .chart-search-list-currency"),{type:"currency",restrict:d,selected:d,filter:"USD"}),filterLists($("#dashSparkModal .chart-search-list-equity"),{type:"equity",restrict:d,selected:d}),filterLists($("#dashG10Modal #dash-g10_macro"),{type:"macro",period:"annual",returnPartner:!0,strictHide:!0,reporter:d},"dropdown"));var r=[];r.push({selector:".spark-asset-commodity input",url:siteData.data("url")+"/autoComplete/commodity?restrict="+d+"&term=%QUERY"}),r.push({selector:".spark-asset-currency input",url:siteData.data("url")+"/autoComplete/currency?restrict="+d+"&filterLike=USD&term=%QUERY"}),r.push({selector:".spark-asset-equity input",url:siteData.data("url")+"/autoComplete/equity?restrict="+d+"&term=%QUERY"}),refreshTypeahead("dash",r,a)}function dashValidateSubmitBtn(){var a=!0;a&&(a=!1,$("#dashSparkModal input").each(function(){void 0!==$(this).data("ref")&&""!=$(this).data("ref")&&(a=!0)})),a?$("#dashSparkModal .chart-submit-btn").addClass("btn-primary btn-inverse").removeClass("btn-disabled"):$("#dashSparkModal .chart-submit-btn").addClass("btn-disabled").removeClass("btn-primary btn-inverse")}$(function(){$(".dash-tabs .tab-pane").data("resized","0"),$("#dash-nav").on("changed.bs.select",function(){var a=$(".dash-tabs #"+$(this).val());$(".dash-tabs .tab-pane").removeClass("active"),a.addClass("active"),"0"==a.data("resized")&&(a.find(".chart-group").each(function(){var a=$(this).data("chart-id");void 0!==chartsLog[a]&&toggleChartSeries(a)}),a.data("resized","1"))}),$(document).on("click",".dash-change-toggle",function(){if(!$(this).hasClass("btn-primary")){$(this).parents(".dash-change-toggles").find(".dash-change-toggle").removeClass("btn-disabled"),$(this).addClass("btn-disabled");var a=$(this).parents(".chart-group").find(".chart-item-data");a.data("report",$(this).data("report")),drawChart(a.data("chart-id"),!0)}}),$(document).on("click",".spark-edit-btn",function(){var a=$(this).parents(".chart-item").data("chart-id");$("#dashSparkModal").data("chart-id",a),$("#dashSparkModal").data("dash-type","spark"),$("#dashSparkModal").data("target",$(this)),$("#dashSparkModal").modal("show")}),$(document).on("click",".yoy-edit-btn",function(){var a=$(this).parents(".chart-item").data("chart-id");$("#dashSparkModal").data("chart-id",a),$("#dashSparkModal").data("dash-type","yoy"),$("#dashSparkModal").data("target",$(this)),$("#dashSparkModal").modal("show")}),$(document).on("click",".macro-edit-btn",function(){var a=$(".dash-g10 .chart-item-data").data("chart-id");$("#dashG10Modal").data("chart-id",a),$("#dashG10Modal").modal("show")}),$(document).on("click",".dash-outlook-item-btn",function(){var a=$(this).parents(".chart-group").find(".chart-item").data("chart-id");$("#dashSparkModal").data("chart-id",a),$("#dashSparkModal").data("dash-type","outlook"),$("#dashSparkModal").data("target",$(this)),$("#dashSparkModal").modal("show")}),$("#dash-spark_market").on("changed.bs.select",function(){$("#dashSparkModal .spark-asset-form-group").slideUp(),$("#dashSparkModal .spark-asset-form-group input").val("").data("ref",""),$("#dashSparkModal .spark-asset-"+$(this).val()).slideDown(),validateSubmitBtn("dash")}),$("#dashSparkModal .chart-submit-btn").click(function(){var a=$(this).parents(".modal").data("chart-id"),t=$(".chart-item-data[data-chart-id="+a+"]"),d=$("#dash-spark_market").selectpicker("val"),r=$("#dashSparkModal .spark-asset-"+d+" input").data("ref"),s=t.data("item"),e=$("#dashSparkModal").data("dash-type"),i=$("#dashSparkModal").data("target");if(!$(this).hasClass("btn-disabled")&&("outlook"===e&&(s=i.data("ref"),i.data("ref",r),i.find(".dash-outlook-item-label").text($("#dashSparkModal .chart-search-list-"+d+" .list-group-item[data-ref="+r+"]").data("label"))),void 0!==a)){$.ajax({url:siteData.data("url")+"/user/dashFavorite/",method:"post",dataType:"json",data:{old:{item:s,market:t.data("market")},new:{item:r,market:d},type:e}});var o=[],h=t.data("item").split(",");for(var l in h)h[l]===s?o.push(r):o.push(h[l]);""===s&&o.push(r),o=o.join(),t.data("market",d),t.data("item",o),drawChart(a),$(this).parents(".modal").modal("hide")}}),$("#dashG10Modal .chart-submit-btn").click(function(){var a=$(this).parents(".modal").data("chart-id"),t=$(".chart-item-data[data-chart-id="+a+"]"),d=$("#dash-g10_macro").selectpicker("val");$(this).hasClass("btn-disabled")||void 0!==a&&($.ajax({url:siteData.data("url")+"/user/dashFavorite/",method:"post",dataType:"json",data:{old:{macro:t.data("macro")},new:{macro:d},type:"g10"}}),t.data("macro",d),drawChart(a),$(this).parents(".modal").modal("hide"))}),dashboardRefreshTypeahead(!0),$("#dashSparkModal").on("show.bs.modal",function(a){var t=$("#dashSparkModal").data("chart-id"),d=$(".chart-item-data[data-chart-id="+t+"]"),r=$("#dashSparkModal").data("dash-type"),s=$("#dashSparkModal").data("target"),e=d.data("market"),i=d.data("item");if("outlook"===r?(i=s.data("ref"),$("#dash-spark_market").parents(".form-group").hide()):$("#dash-spark_market").parents(".form-group").show(),""===i)var o="";else o=$("#dashSparkModal .chart-search-list-"+e+" .list-group-item[data-ref="+i+"]").data("label");dashboardRefreshTypeahead(!1,s.parents(".dash-group")),$(".dashSparkModal-title").hide(),$("#dashSparkModal .title-"+r).show(),$("#dash-spark_market").selectpicker("val",e),$("#dashSparkModal .spark-asset-form-group").hide(),$("#dashSparkModal .spark-asset-form-group input").val(""),$("#dashSparkModal .spark-asset-"+e+" input").val(o).data("ref",i),$("#dashSparkModal .spark-asset-"+e).show()}),$("#dashG10Modal").on("show.bs.modal",function(a){var t=$("#dashG10Modal").data("chart-id"),d=$(".chart-item-data[data-chart-id="+t+"]").data("macro");dashboardRefreshTypeahead(!1,$(".dash-g10")),$("#dash-g10_macro").selectpicker("val",d)}),$("#dashSparkModal").on("shown.bs.modal",function(a){validateSubmitBtn("dash")})});